# k-Nearest Neighbors (kNN) —Å kd-tree –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è

–ü—ä–ª–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç—ä–º–∞ k-Nearest Neighbors (kNN) —Å –¥–≤–µ –≤–µ—Ä—Å–∏–∏:

- **–ù–∞–∏–≤–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è** - O(n) —Å–ª–æ–∂–Ω–æ—Å—Ç –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ
- **kd-tree –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è** - O(log n) —Å–ª–æ–∂–Ω–æ—Å—Ç –∑–∞ —Ç—ä—Ä—Å–µ–Ω–µ

–ü—Ä–æ–µ–∫—Ç—ä—Ç –∏–∑–ø–æ–ª–∑–≤–∞ Iris dataset –∏ –≤–∫–ª—é—á–≤–∞:

- Min-Max –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–æ —Ä–∞–∑–¥–µ–ª—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ (80/20)
- 10-–∫—Ä–∞—Ç–Ω–∞ –∫—Ä—ä—Å—Ç–æ—Å–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ (10-fold cross-validation)
- –°—Ä–∞–≤–Ω–∏—Ç–µ–ª–µ–Ω –∞–Ω–∞–ª–∏–∑ –º–µ–∂–¥—É –¥–≤–µ—Ç–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—Ç–∞ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ k

---

## üìã –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ

- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–Ω–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è](#–∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—è)
- [–ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ](#–∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ)
- [–ö–∞–∫ —Ä–∞–±–æ—Ç–∏ kNN](#–∫–∞–∫-—Ä–∞–±–æ—Ç–∏-knn)
- [–ö–∞–∫–≤–æ –µ kd-tree](#–∫–∞–∫–≤–æ-–µ-kd-tree)
- [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∞-–æ–±—Ä–∞–±–æ—Ç–∫–∞)
- [–û—Ü–µ–Ω–∫–∞ –Ω–∞ –º–æ–¥–µ–ª–∞](#–æ—Ü–µ–Ω–∫–∞-–Ω–∞-–º–æ–¥–µ–ª–∞)
- [–†–µ–∑—É–ª—Ç–∞—Ç–∏](#—Ä–µ–∑—É–ª—Ç–∞—Ç–∏)
- [–û–±—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞](#–æ–±—è—Å–Ω–µ–Ω–∏–µ-–Ω–∞-–∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îÇ
‚îú‚îÄ‚îÄ kdtree.py          # kd-tree –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è (–º–æ–¥—É–ª)
‚îú‚îÄ‚îÄ main.py            # –ì–ª–∞–≤–µ–Ω —Ñ–∞–π–ª —Å –Ω–∞–∏–≤–Ω–∞ kNN –∏ —Ç–µ—Å—Ç–≤–∞–Ω–µ
‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîß –ò–Ω—Å—Ç–∞–ª–∞—Ü–∏—è

### –ù–µ–æ–±—Ö–æ–¥–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```bash
pip install ucimlrepo matplotlib
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –æ—Ç –¥–∞–Ω–Ω–∏:

- `random` - –∑–∞ —Å–ª—É—á–∞–π–Ω–æ —Ä–∞–∑–¥–µ–ª—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ
- `math` - –∑–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `copy` - –∑–∞ –∫–æ–ø–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏
- `matplotlib` - –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

---

## üöÄ –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ

### –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞—Ç–∞:

```bash
python main.py
```

### –ü—Ä–∏–º–µ—Ä–µ–Ω –≤—Ö–æ–¥:

```
–í—ä–≤–µ–¥–µ—Ç–µ k: 11
```

### –ü—Ä–∏–º–µ—Ä–µ–Ω –∏–∑—Ö–æ–¥:

```
============================================================
–¢–ï–°–¢–í–ê–ù–ï –° –ù–ê–ò–í–ù–ê kNN –ò–ú–ü–õ–ï–ú–ï–ù–¢–ê–¶–ò–Ø
============================================================

1. Train Accuracy: 96.7 %

2. 10-Fold Cross-Validation Results:

Accuracy Fold 1: 93.3%
Accuracy Fold 2: 96.7%
Accuracy Fold 3: 93.3%
Accuracy Fold 4: 90.0%
Accuracy Fold 5: 96.7%
Accuracy Fold 6: 93.3%
Accuracy Fold 7: 96.7%
Accuracy Fold 8: 93.3%
Accuracy Fold 9: 93.3%
Accuracy Fold 10: 96.7%

Average Accuracy: 94.5 %
Standard Deviation: 2.3 %

3. Test Set Accuracy: 95.0 %

============================================================
–¢–ï–°–¢–í–ê–ù–ï –° KD-TREE –ò–ú–ü–õ–ï–ú–ï–ù–¢–ê–¶–ò–Ø
============================================================

1. Train Accuracy (kd-tree): 96.7 %

2. 10-Fold Cross-Validation Results (kd-tree):

Accuracy Fold 1: 93.3%
...

Average Accuracy (kd-tree): 94.5 %
Standard Deviation (kd-tree): 2.3 %

3. Test Set Accuracy (kd-tree): 95.0 %

============================================================
–ì–ï–ù–ï–†–ò–†–ê–ù–ï –ù–ê –ì–†–ê–§–ò–ö–ê...
============================================================
```

–°–ª–µ–¥ —Ç–æ–≤–∞ —Å–µ –ø–æ–∫–∞–∑–≤–∞ –≥—Ä–∞—Ñ–∏–∫–∞ —Å—Ä–∞–≤–Ω—è–≤–∞—â–∞ —Ç–æ—á–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –¥–≤–µ—Ç–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –Ω–∞ k.

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∏ kNN

### –ê–ª–≥–æ—Ä–∏—Ç—ä–º:

k-Nearest Neighbors (kNN) –µ –∞–ª–≥–æ—Ä–∏—Ç—ä–º –∑–∞ –∫–ª–∞—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –∫–æ–π—Ç–æ —Ä–∞–±–æ—Ç–∏ –ø–æ —Å–ª–µ–¥–Ω–∏—è –Ω–∞—á–∏–Ω:

1. **–ò–∑–±–æ—Ä –Ω–∞ k** - –æ–ø—Ä–µ–¥–µ–ª—è–º–µ –±—Ä–æ—è –Ω–∞ —Å—ä—Å–µ–¥–∏—Ç–µ, –∫–æ–∏—Ç–æ —â–µ —Ä–∞–∑–≥–ª–µ–∂–¥–∞–º–µ
2. **–ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏—è** - –∑–∞ –¥–∞–¥–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞ —Ç–æ—á–∫–∞ –∏–∑—á–∏—Å–ª—è–≤–∞–º–µ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –¥–æ –≤—Å–∏—á–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤—ä—á–Ω–∏ —Ç–æ—á–∫–∏
3. **–ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ k —Å—ä—Å–µ–¥–∏** - –∏–∑–±–∏—Ä–∞–º–µ k —Ç–æ—á–∫–∏ —Å –Ω–∞–π-–º–∞–ª–∫–æ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ
4. **–ì–ª–∞—Å—É–≤–∞–Ω–µ** - –∫–ª–∞—Å—ä—Ç, –∫–æ–π—Ç–æ —Å–µ —Å—Ä–µ—â–∞ –Ω–∞–π-—á–µ—Å—Ç–æ —Å—Ä–µ–¥ k —Å—ä—Å–µ–¥–∏—Ç–µ, –µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ç –∫–ª–∞—Å

### –ï–≤–∫–ª–∏–¥–æ–≤–æ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ:

```
d(p, q) = ‚àö[(p‚ÇÅ-q‚ÇÅ)¬≤ + (p‚ÇÇ-q‚ÇÇ)¬≤ + ... + (p‚Çô-q‚Çô)¬≤]
```

### –ü—Ä–∏–º–µ—Ä:

–ó–∞ —Ç–æ—á–∫–∞ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ `[5.1, 3.5, 1.4, 0.2]` –∏ k=3:

```
–ù–∞–π-–±–ª–∏–∑–∫–∏ —Å—ä—Å–µ–¥–∏:
1. [5.0, 3.6, 1.4, 0.2] - Iris-setosa    (—Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ: 0.14)
2. [5.1, 3.8, 1.5, 0.3] - Iris-setosa    (—Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ: 0.36)
3. [4.9, 3.4, 1.4, 0.2] - Iris-setosa    (—Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ: 0.28)

–ì–ª–∞—Å–æ–≤–µ: Iris-setosa (3)
–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: Iris-setosa
```

---

## üå≥ –ö–∞–∫–≤–æ –µ kd-tree

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:

kd-tree (k-dimensional tree) –µ –¥—ä—Ä–≤–æ–≤–∏–¥–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç –¥–∞–Ω–Ω–∏ –∑–∞ –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–æ—á–∫–∏ –≤ k-–º–µ—Ä–Ω–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ. –ü–æ–∑–≤–æ–ª—è–≤–∞ **–ø–æ-–±—ä—Ä–∑–æ —Ç—ä—Ä—Å–µ–Ω–µ** –Ω–∞ –Ω–∞–π-–±–ª–∏–∑–∫–∏ —Å—ä—Å–µ–¥–∏.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∏:

#### 1. **–ò–∑–≥—Ä–∞–∂–¥–∞–Ω–µ –Ω–∞ –¥—ä—Ä–≤–æ—Ç–æ:**

```
–î–∞–Ω–Ω–∏: [(5.1, 3.5), (4.9, 3.0), (6.2, 2.9), (5.8, 2.7), ...]

–ù–∏–≤–æ 0 (–æ—Å x):
                [5.1, 3.5]
               /          \
   (x < 5.1) /            \ (x >= 5.1)
            /              \
      [4.9, 3.0]        [6.2, 2.9]

–ù–∏–≤–æ 1 (–æ—Å y):
   [4.9, 3.0]              [6.2, 2.9]
   /                       /        \
  ...                [5.8, 2.7]  [6.7, 3.1]
```

**–°—Ç—ä–ø–∫–∏:**

1. –ò–∑–±–∏—Ä–∞–º–µ –æ—Å –∑–∞ —Ä–∞–∑–¥–µ–ª—è–Ω–µ (—Ä–µ–¥—É–≤–∞—Ç —Å–µ: x, y, z, ...)
2. –°–æ—Ä—Ç–∏—Ä–∞–º–µ —Ç–æ—á–∫–∏—Ç–µ –ø–æ —Ç–∞–∑–∏ –æ—Å
3. –ò–∑–±–∏—Ä–∞–º–µ –º–µ–¥–∏–∞–Ω–∞—Ç–∞ –∫–∞—Ç–æ –∫–æ—Ä–µ–Ω
4. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å—Ç—Ä–æ–∏–º –ª—è–≤–æ –∏ –¥—è—Å–Ω–æ –ø–æ–¥–¥—ä—Ä–≤–æ

#### 2. **–¢—ä—Ä—Å–µ–Ω–µ –Ω–∞ k —Å—ä—Å–µ–¥–∏:**

```python
–¢—ä—Ä—Å–∏–º 3 –Ω–∞–π-–±–ª–∏–∑–∫–∏ —Å—ä—Å–µ–¥–∏ –∑–∞ —Ç–æ—á–∫–∞ [5.5, 3.2]

1. –ó–∞–ø–æ—á–≤–∞–º–µ –æ—Ç –∫–æ—Ä–µ–Ω–∞ [5.1, 3.5]
2. 5.5 > 5.1 ‚Üí –æ—Ç–∏–≤–∞–º–µ –≤–¥—è—Å–Ω–æ
3. –ò–∑—á–∏—Å–ª—è–≤–∞–º–µ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ –¥–æ [6.2, 2.9]
4. –ü—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ –¥–∞–ª–∏ —Ç—Ä—è–±–≤–∞ –¥–∞ —Ç—ä—Ä—Å–∏–º –∏ –≤–ª—è–≤–æ:
   - –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –¥–æ —Ä–∞–∑–¥–µ–ª—è—â–∞—Ç–∞ –ª–∏–Ω–∏—è (|5.5 - 5.1| = 0.4)
   - –ê–∫–æ –µ –ø–æ-–º–∞–ª–∫–æ –æ—Ç —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –¥–æ 3-—Ç–∏—è —Å—ä—Å–µ–¥ ‚Üí —Ç—ä—Ä—Å–∏–º –∏ —Ç–∞–º
```

#### 3. **Pruning (–æ—Ç—Ä—è–∑–≤–∞–Ω–µ):**

–ö–ª—é—á–æ–≤–æ—Ç–æ –ø—Ä–µ–¥–∏–º—Å—Ç–≤–æ –Ω–∞ kd-tree –µ **pruning** - –ø—Ä–æ–ø—É—Å–∫–∞–Ω–µ –Ω–∞ —Ü–µ–ª–∏ –ø–æ–¥–¥—ä—Ä–≤–µ—Ç–∞:

```
        [–∫–æ—Ä–µ–Ω]
       /       \
   [–ª—è–≤–æ]    [–¥—è—Å–Ω–æ]

–ê–∫–æ query —Ç–æ—á–∫–∞—Ç–∞ –µ –º–Ω–æ–≥–æ –±–ª–∏–∑–æ –¥–æ –¥—è—Å–Ω–æ—Ç–æ –ø–æ–¥–¥—ä—Ä–≤–æ,
–∏ –ª—è–≤–æ—Ç–æ –ø–æ–¥–¥—ä—Ä–≤–æ –µ —Ç–≤—ä—Ä–¥–µ –¥–∞–ª–µ—á ‚Üí –ü–†–û–ü–£–°–ö–ê–ú–ï –ª—è–≤–æ—Ç–æ!
```

### –°–ª–æ–∂–Ω–æ—Å—Ç:

| –û–ø–µ—Ä–∞—Ü–∏—è          | –ù–∞–∏–≤–Ω–∞ kNN | kd-tree                        |
| ----------------- | ---------- | ------------------------------ |
| –ò–∑–≥—Ä–∞–∂–¥–∞–Ω–µ        | O(1)       | O(n log n)                     |
| –¢—ä—Ä—Å–µ–Ω–µ (1 —Ç–æ—á–∫–∞) | O(n)       | O(log n) —Å—Ä–µ–¥–Ω–æ, O(n) –Ω–∞–π-–ª–æ—à–æ |
| m query —Ç–æ—á–∫–∏     | O(m √ó n)   | O(n log n + m log n)           |

### –ö–æ–≥–∞ kd-tree –µ –ø–æ-–¥–æ–±—Ä–æ:

‚úÖ **–ú–Ω–æ–≥–æ query —Ç–æ—á–∫–∏** (>100)  
‚úÖ **–ú–∞–ª–∫–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è** (<20)  
‚úÖ **–ì–æ–ª—è–º dataset** (>10,000 —Ç–æ—á–∫–∏)

‚ùå **–ú–∞–ª–∫–æ query —Ç–æ—á–∫–∏** (1-10)  
‚ùå **–ú–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è** (>20) - "curse of dimensionality"

---

## üîÑ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞

### 1. Min-Max –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

**–§–æ—Ä–º—É–ª–∞:**

```
x_norm = (x - x_min) / (x_max - x_min)
```

**–ó–∞—â–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞:**

kNN –∏–∑–ø–æ–ª–∑–≤–∞ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∏. –ê–∫–æ –µ–¥–Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–º–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ 0-100, –∞ –¥—Ä—É–≥–∞ 0-1, –ø—ä—Ä–≤–∞—Ç–∞ —â–µ –¥–æ–º–∏–Ω–∏—Ä–∞:

```
–ë–ï–ó –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
–¢–æ—á–∫–∞ 1: [100, 0.5, 0.3, 0.1]
–¢–æ—á–∫–∞ 2: [101, 0.9, 0.8, 0.9]
–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ: ‚àö[(100-101)¬≤ + (0.5-0.9)¬≤ + ...] ‚âà 1.0
           ‚îî‚îÄ –¥–æ–º–∏–Ω–∏—Ä–∞!

–° –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
–¢–æ—á–∫–∞ 1: [0.50, 0.25, 0.15, 0.05]
–¢–æ—á–∫–∞ 2: [0.51, 0.45, 0.40, 0.45]
–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ: ‚àö[(0.50-0.51)¬≤ + (0.25-0.45)¬≤ + ...] ‚âà 0.45
           ‚îî‚îÄ –≤—Å–∏—á–∫–∏ —Å–∞ —Ä–∞–≤–Ω–æ–ø–æ—Å—Ç–∞–≤–µ–Ω–∏
```

### 2. –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–∞–Ω–æ —Ä–∞–∑–¥–µ–ª—è–Ω–µ (80/20)

**–ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏:**

–ó–∞–ø–∞–∑–≤–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏—Ç–µ –Ω–∞ –∫–ª–∞—Å–æ–≤–µ—Ç–µ –≤ train –∏ test –º–Ω–æ–∂–µ—Å—Ç–≤–∞—Ç–∞.

```
Iris dataset: 50 Setosa, 50 Versicolor, 50 Virginica

–õ–û–®–û —Ä–∞–∑–¥–µ–ª—è–Ω–µ (random):
Train: 45 Setosa, 48 Versicolor, 27 Virginica  ‚Üê –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ!
Test:  5 Setosa,  2 Versicolor,  23 Virginica

–î–û–ë–†–û —Ä–∞–∑–¥–µ–ª—è–Ω–µ (stratified):
Train: 40 Setosa, 40 Versicolor, 40 Virginica  ‚Üê —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ!
Test:  10 Setosa, 10 Versicolor, 10 Virginica
```

**–ó–∞—â–æ –µ –≤–∞–∂–Ω–æ:**

- –ò–∑–±—è–≥–≤–∞–º–µ bias –∫—ä–º –µ–¥–∏–Ω –∫–ª–∞—Å
- –ü–æ-–Ω–∞–¥–µ–∂–¥–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –º–æ–¥–µ–ª–∞
- –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ

---

## üìä –û—Ü–µ–Ω–∫–∞ –Ω–∞ –º–æ–¥–µ–ª–∞

### 1. Train Set Accuracy

**–ö–∞–∫–≤–æ –ø–æ–∫–∞–∑–≤–∞:**  
–ö–æ–ª–∫–æ –¥–æ–±—Ä–µ –º–æ–¥–µ–ª—ä—Ç "–ø–æ–º–Ω–∏" –¥–∞–Ω–Ω–∏—Ç–µ, –Ω–∞ –∫–æ–∏—Ç–æ –µ —Ç—Ä–µ–Ω–∏—Ä–∞–ª.

**–û—á–∞–∫–≤–∞–Ω–æ:**  
–í–∏—Å–æ–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç (>90%) - –º–æ–¥–µ–ª—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –ø–æ–∑–Ω–∞–≤–∞ —Å–≤–æ–∏—Ç–µ –¥–∞–Ω–Ω–∏.

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:**  
–ê–∫–æ –µ 100%, –≤—ä–∑–º–æ–∂–Ω–æ –µ **overfitting**.

### 2. 10-Fold Cross-Validation

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∏:**

```
–î–∞–Ω–Ω–∏: [1 2 3 4 5 6 7 8 9 10]

Fold 1: Train [2-10], Test [1]
Fold 2: Train [1,3-10], Test [2]
Fold 3: Train [1-2,4-10], Test [3]
...
Fold 10: Train [1-9], Test [10]

Average Accuracy = (acc‚ÇÅ + acc‚ÇÇ + ... + acc‚ÇÅ‚ÇÄ) / 10
```

**–ó–∞—â–æ –µ –≤–∞–∂–Ω–∞:**

- –ü–æ-–Ω–∞–¥–µ–∂–¥–Ω–∞ –æ—Ü–µ–Ω–∫–∞ –æ—Ç –µ–¥–Ω–æ —Ä–∞–∑–¥–µ–ª—è–Ω–µ
- –í—Å—è–∫–∞ —Ç–æ—á–∫–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –∏ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞, –∏ –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ
- –ù–∞–º–∞–ª—è–≤–∞ –≤–ª–∏—è–Ω–∏–µ—Ç–æ –Ω–∞ "–∫—ä—Å–º–µ—Ç–∞" –ø—Ä–∏ —Ä–∞–∑–¥–µ–ª—è–Ω–µ—Ç–æ

### 3. Test Set Accuracy

**–ö–∞–∫–≤–æ –ø–æ–∫–∞–∑–≤–∞:**  
–ö–∞–∫ –º–æ–¥–µ–ª—ä—Ç —Ä–∞–±–æ—Ç–∏ –≤—ä—Ä—Ö—É **–Ω–∞–ø—ä–ª–Ω–æ –Ω–æ–≤–∏ –¥–∞–Ω–Ω–∏**, –∫–æ–∏—Ç–æ –Ω–∏–∫–æ–≥–∞ –Ω–µ –µ –≤–∏–∂–¥–∞–ª.

**–û—á–∞–∫–≤–∞–Ω–æ:**  
–ë–ª–∏–∑–∫–∞ –¥–æ CV accuracy (¬±5%). –ê–∫–æ –µ –º–Ω–æ–≥–æ –ø–æ-–Ω–∏—Å–∫–∞ ‚Üí overfitting.

### 4. Standard Deviation (œÉ)

**–ö–∞–∫–≤–æ –ø–æ–∫–∞–∑–≤–∞:**  
–ö–æ–ª–∫–æ **—Å—Ç–∞–±–∏–ª–µ–Ω** –µ –º–æ–¥–µ–ª—ä—Ç.

```
–ù–∏—Å—ä–∫ œÉ (<5%): –°—Ç–∞–±–∏–ª–µ–Ω –º–æ–¥–µ–ª, –ø—Ä–µ–¥–≤–∏–¥–∏–º–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏
–í–∏—Å–æ–∫ œÉ (>10%): –ù–µ—Å—Ç–∞–±–∏–ª–µ–Ω –º–æ–¥–µ–ª, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫—ä–º –¥–∞–Ω–Ω–∏—Ç–µ
```

---

## üìà –†–µ–∑—É–ª—Ç–∞—Ç–∏

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ù–∞–∏–≤–Ω–∞ vs kd-tree

| –ú–µ—Ç—Ä–∏–∫–∞                    | –ù–∞–∏–≤–Ω–∞ kNN   | kd-tree kNN  |
| -------------------------- | ------------ | ------------ |
| Train Accuracy             | 96.7%        | 96.7%        |
| CV Average                 | 94.5%        | 94.5%        |
| CV Std Dev                 | 2.3%         | 2.3%         |
| Test Accuracy              | 95.0%        | 95.0%        |
| **–¢–æ—á–Ω–æ—Å—Ç**                | ‚úÖ –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ | ‚úÖ –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ |
| **–°–∫–æ—Ä–æ—Å—Ç (150 —Ç–æ—á–∫–∏)**    | ~0.1s        | ~0.1s        |
| **–°–∫–æ—Ä–æ—Å—Ç (10,000 —Ç–æ—á–∫–∏)** | ~10s         | ~0.5s        |

### –ò–∑–±–æ—Ä –Ω–∞ k

```
k=1:  –ú–Ω–æ–≥–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫—ä–º —à—É–º, overfitting
k=3:  –î–æ–±—ä—Ä –±–∞–ª–∞–Ω—Å –∑–∞ –º–∞–ª–∫–∏ datasets
k=5-11: –û–ø—Ç–∏–º–∞–ª–Ω–∏ –∑–∞ Iris (–æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ)
k=‚àön: –û–±—â–æ –ø—Ä–∞–≤–∏–ª–æ (‚àö150 ‚âà 12)
k‚Üín:  Underfitting, –ø—Ä–µ–∫–∞–ª–µ–Ω–æ –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∏—Ä–∞–Ω
```

**–ü—Ä–∞–≤–∏–ª–æ –Ω–∞ –ø–∞–ª–µ—Ü–∞:**  
–ò–∑–ø—Ä–æ–±–≤–∞–π—Ç–µ –Ω–µ—á–µ—Ç–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (1, 3, 5, 7, ...) –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ—Ç–µ —Ä–∞–≤–µ–Ω –±—Ä–æ–π –≥–ª–∞—Å–æ–≤–µ.

---

## üîç –û–±—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ `kdtree.py`

#### 1. **KDNode –∫–ª–∞—Å**

```python
class KDNode:
    def __init__(self, point, label, axis, left=None, right=None):
        self.point = point      # [5.1, 3.5, 1.4, 0.2]
        self.label = label      # "Iris-setosa"
        self.axis = axis        # 0, 1, 2, –∏–ª–∏ 3 (–∫–æ—è –æ—Å)
        self.left = left        # –ª—è–≤–æ –ø–æ–¥–¥—ä—Ä–≤–æ
        self.right = right      # –¥—è—Å–Ω–æ –ø–æ–¥–¥—ä—Ä–≤–æ
```

#### 2. **build_kdtree()**

```python
–ü—Ä–∏–º–µ—Ä —Å 7 —Ç–æ—á–∫–∏ (2D –∑–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞):

–¢–æ—á–∫–∏: [(2,3), (5,4), (9,6), (4,7), (8,1), (7,2)]

–°—Ç—ä–ø–∫–∞ 1: –û—Å X (axis=0)
–°–æ—Ä—Ç–∏—Ä–∞–Ω–∏: [(2,3), (4,7), (5,4), (7,2), (8,1), (9,6)]
–ú–µ–¥–∏–∞–Ω–∞: (7,2) ‚Üê –∫–æ—Ä–µ–Ω

–°—Ç—ä–ø–∫–∞ 2: –õ—è–≤–æ –æ—Ç (7,2) ‚Üí –æ—Å Y (axis=1)
[(2,3), (4,7), (5,4)]
–°–æ—Ä—Ç–∏—Ä–∞–Ω–∏ –ø–æ Y: [(2,3), (5,4), (4,7)]
–ú–µ–¥–∏–∞–Ω–∞: (5,4)

–°—Ç—ä–ø–∫–∞ 3: –î—è—Å–Ω–æ –æ—Ç (7,2) ‚Üí –æ—Å Y
[(8,1), (9,6)]
–°–æ—Ä—Ç–∏—Ä–∞–Ω–∏ –ø–æ Y: [(8,1), (9,6)]
–ú–µ–¥–∏–∞–Ω–∞: (8,1)

–†–µ–∑—É–ª—Ç–∞—Ç:
        (7,2) [–æ—Å X]
       /           \
    (5,4) [–æ—Å Y]   (8,1) [–æ—Å Y]
    /    \              \
 (2,3) (4,7)          (9,6)
```

#### 3. **kdtree_knn_search()**

```python
–¢—ä—Ä—Å–µ–Ω–µ –∑–∞ —Ç–æ—á–∫–∞ (6,3) —Å k=2:

1. –ó–∞–ø–æ—á–≤–∞–º–µ –æ—Ç (7,2):
   - –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ: ‚àö[(7-6)¬≤ + (2-3)¬≤] = ‚àö2 ‚âà 1.41
   - Best: [(1.41, "Iris-setosa")]

2. 6 < 7 ‚Üí –æ—Ç–∏–≤–∞–º–µ –õ–Ø–í–û –∫—ä–º (5,4):
   - –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ: ‚àö[(5-6)¬≤ + (4-3)¬≤] = ‚àö2 ‚âà 1.41
   - Best: [(1.41, "Iris-setosa"), (1.41, "Iris-versicolor")]

3. –ü—Ä–æ–¥—ä–ª–∂–∞–≤–∞–º–µ –Ω–∞–¥–æ–ª—É...

4. PRUNING –ø—Ä–æ–≤–µ—Ä–∫–∞:
   - –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ö–∏–ø–µ—Ä—Ä–∞–≤–Ω–∏–Ω–∞: |6-7| = 1
   - –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ –¥–æ 2-—Ä–∏ —Å—ä—Å–µ–¥: 1.41
   - 1 < 1.41 ‚Üí –¢–™–†–°–ò–ú –∏ –¥—è—Å–Ω–æ! (–º–æ–∂–µ –¥–∞ –∏–º–∞ –ø–æ-–±–ª–∏–∑–∫–∏)
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ `main.py`

#### –û—Å–Ω–æ–≤–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **`min_max_normalize()`** - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è [0, 1]
2. **`stratified_split()`** - –†–∞–∑–¥–µ–ª—è–Ω–µ —Å—ä—Å –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏
3. **`euclidean()`** - –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ —Ä–∞–∑—Å—Ç–æ—è–Ω–∏–µ
4. **`knn_predict()`** - –ù–∞–∏–≤–Ω–∞ kNN –∫–ª–∞—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
5. **`accuracy()`** - –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç
6. **`cross_validation_10()`** - 10-fold CV
7. **`plot_accuracy_k()`** - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

---

## üìù –ë–µ–ª–µ–∂–∫–∏

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ kd-tree:

1. **Curse of dimensionality**: –ü—Ä–∏ >20 –∏–∑–º–µ—Ä–µ–Ω–∏—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—Ç–∞ –ø–∞–¥–∞ –¥–æ O(n)
2. **–ë–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–µ**: –ù–∞—à–∞—Ç–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä–æ–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–∞–Ω–æ –¥—ä—Ä–≤–æ, –Ω–æ –ø—Ä–∏ –¥–∏–Ω–∞–º–∏—á–Ω–∏ –¥–∞–Ω–Ω–∏ –º–æ–∂–µ –¥–∞ —Å–µ —Ä–∞–∑–±–∞–ª–∞–Ω—Å–∏—Ä–∞
3. **–ü–∞–º–µ—Ç**: –ò–∑–ø–æ–ª–∑–≤–∞ –ø–æ–≤–µ—á–µ –ø–∞–º–µ—Ç –æ—Ç –Ω–∞–∏–≤–Ω–∞—Ç–∞ –≤–µ—Ä—Å–∏—è (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –¥—ä—Ä–≤–æ)

### –ü–æ–¥–æ–±—Ä–µ–Ω–∏—è:

- –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ heap –≤–º–µ—Å—Ç–æ —Å–æ—Ä—Ç–∏—Ä–∞–Ω–µ –ø—Ä–∏ —Ç—ä—Ä—Å–µ–Ω–µ (O(log k) –≤–º–µ—Å—Ç–æ O(k log k))
- Ball tree –∑–∞ –º–Ω–æ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è
- Approximate nearest neighbors (LSH) –∑–∞ –æ–≥—Ä–æ–º–Ω–∏ datasets

---

## üìö –†–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏

- [k-nearest neighbors tutorial 1](https://www.youtube.com/watch?v=SnFqx3M28wQ)
- [k-nearest neighbors tutorial 2](https://www.youtube.com/watch?v=oQQrxiJvnhw&t=13s)

---
